using Microsoft.Win32;
using System;
using System.Diagnostics;

namespace InnoFileDropper
{
    class StartAppManager
    {
        string AppName = "InnoFileDropper";
        string version = "0.0.1";
        string myKey = "InnoFileDropper";
        string myValue = System.Diagnostics.Process.GetCurrentProcess().MainModule.FileName;

        public void SetStartup()
        {
            string strExeFilePath = System.Reflection.Assembly.GetExecutingAssembly().Location;
            string strWorkPath = System.IO.Path.GetDirectoryName(strExeFilePath);

            RegistryKey key = Registry.CurrentUser.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run", true);

            try
            {
                key.SetValue(myKey, myValue);
                Console.WriteLine("Set to Startup");
                Debug.WriteLine("App name : {0} and App version: {1}", AppName, version);
            }
            catch (Exception e)
            {
                Console.WriteLine(e.Message);
            }


        }
    }
}
